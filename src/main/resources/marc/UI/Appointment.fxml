<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.Region?>

<VBox fx:id="patientAppointmentPanel" spacing="15.0" style="-fx-background-color: white; -fx-padding: 20;" stylesheets="@../../css/industrial_theme.css"
      xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="marc.Controllers.PatientAppointmentManagementController">

    <!-- HEADER -->
    <HBox alignment="CENTER_LEFT" spacing="20">
        <Label text="Appointment Scheduler" styleClass="header-label"/>
        <Region HBox.hgrow="ALWAYS" />
        <TextField fx:id="searchAppointmentField" promptText="Search appointments..." prefWidth="300" styleClass="text-field"/>
    </HBox>

    <!-- TABLE -->
    <TableView fx:id="appointmentTable" VBox.vgrow="ALWAYS" styleClass="table-view">
        <columns>
            <TableColumn fx:id="colAppointmentPatientID" text="Pat ID" prefWidth="60"/>
            <TableColumn fx:id="colAppointmentPatientName" text="Patient Name" prefWidth="150"/>
            <TableColumn fx:id="colAppointmentEmployeeName" text="Doctor/Staff" prefWidth="150"/>
            <TableColumn fx:id="colAppointmentDate" text="Date &amp; Time" prefWidth="150"/>
            <TableColumn fx:id="colAppointmentIsComplete" text="Complete" prefWidth="80"/>
            <TableColumn fx:id="colAppointmentIsCancelled" text="Cancelled" prefWidth="80"/>
            <TableColumn fx:id="colAppointmentIsNoShow" text="No Show" prefWidth="80"/>
            <TableColumn fx:id="colAppointmentCreatedOn" text="Created On" prefWidth="120"/>
            <!-- Hidden ID Column -->
            <TableColumn fx:id="colAppointmentEmployeeID" text="Emp ID" visible="false"/>
        </columns>
        <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
        </columnResizePolicy>
    </TableView>

    <!-- FOOTER FORM (Refactored to 2 Rows for better spacing) -->
    <VBox spacing="10" style="-fx-background-color: #f8f9fa; -fx-padding: 15; -fx-background-radius: 4; -fx-border-color: #dee2e6;">

        <!-- Row 1: Inputs -->
        <HBox spacing="20" alignment="CENTER_LEFT">
            <VBox spacing="5" HBox.hgrow="ALWAYS">
                <Label text="Patient" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                <ComboBox fx:id="appointmentPatientDropdown" promptText="Select Patient..." maxWidth="Infinity" styleClass="combo-box"/>
            </VBox>

            <VBox spacing="5" HBox.hgrow="ALWAYS">
                <Label text="Staff / Doctor" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                <ComboBox fx:id="appointmentEmployeeDropdown" promptText="Select Staff..." maxWidth="Infinity" styleClass="combo-box"/>
            </VBox>

            <VBox spacing="5" prefWidth="250">
                <Label text="Appointment Date" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                <DatePicker fx:id="appointmentDatePicker" maxWidth="Infinity"/>
            </VBox>
        </HBox>

        <!-- Row 2: Status & Actions -->
        <HBox spacing="20" alignment="CENTER_LEFT">
            <VBox spacing="5">
                <Label text="Status" style="-fx-font-size: 11px; -fx-text-fill: #64748b;"/>
                <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-background-color: white; -fx-border-color: #cbd5e1; -fx-border-radius: 4; -fx-padding: 6 15;">
                    <CheckBox fx:id="appointmentIsCompleteCheckBox" text="Completed"/>
                    <CheckBox fx:id="appointmentIsCancelledCheckBox" text="Cancelled"/>
                    <CheckBox fx:id="appointmentIsNoShowCheckBox" text="No Show"/>
                </HBox>
            </VBox>

            <Region HBox.hgrow="ALWAYS" />

            <!-- Buttons with minWidth to prevent crushing -->
            <HBox spacing="10" alignment="BOTTOM_RIGHT">
                <Button fx:id="addAppointmentButton" text="Schedule" onAction="#handleAddAppointment" styleClass="action-btn" prefWidth="100" minWidth="100"/>
                <Button fx:id="updateAppointmentButton" text="Update" onAction="#handleUpdateAppointment" styleClass="secondary-btn" prefWidth="100" minWidth="100"/>
                <Button fx:id="deleteAppointmentButton" text="Delete" onAction="#handleDeleteAppointment" styleClass="delete-btn" prefWidth="100" minWidth="100"/>
            </HBox>
        </HBox>

    </VBox>
</VBox>