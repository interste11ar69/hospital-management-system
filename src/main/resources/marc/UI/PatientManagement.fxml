<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<SplitPane dividerPositions="0.38" prefHeight="700.0" prefWidth="990.0" stylesheets="@../../css/industrial_theme.css"
           xmlns="http://javafx.com/javafx/23.0.1" xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="marc.Controllers.PatientManagementController">

    <!-- LEFT SIDE: THE LIST -->
    <VBox fx:id="patientPanel" spacing="10.0" style="-fx-background-color: white; -fx-padding: 10;">
        <Label text="Patient Directory" styleClass="header-label" style="-fx-font-size: 16px;"/>

        <TextField fx:id="searchPatientField" promptText="Search name..." styleClass="text-field"/>

        <TableView fx:id="patientTable" VBox.vgrow="ALWAYS" styleClass="table-view">
            <columns>
                <TableColumn fx:id="colFirstNamePatient" text="First Name" prefWidth="100"/>
                <TableColumn fx:id="colLastNamePatient" text="Last Name" prefWidth="100"/>
                <TableColumn fx:id="colGenderPatient" text="Gender" prefWidth="60"/> <!-- FIXED: Now Visible -->
                <TableColumn fx:id="colIsActivePatient" text="Status" prefWidth="80"/>

                <!-- Hidden Columns -->
                <TableColumn fx:id="colPatientID" visible="false"/>
                <TableColumn fx:id="colPhoneNumberPatient" visible="false"/>
                <TableColumn fx:id="colEmailPatient" visible="false"/>
                <TableColumn fx:id="colDateOfBirthPatient" visible="false"/>
                <TableColumn fx:id="colBloodGroupPatient" visible="false"/>
                <TableColumn fx:id="colHeightPatient" visible="false"/>
                <TableColumn fx:id="colWeightPatient" visible="false"/>
            </columns>
            <columnResizePolicy>
                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
            </columnResizePolicy>
        </TableView>

        <Button fx:id="btnRegisterPatient" text="+ Register New Patient" onAction="#showRegisterPatientPanel" styleClass="action-btn" maxWidth="Infinity"/>
    </VBox>

    <!-- RIGHT SIDE: THE FILE -->
    <ScrollPane fitToWidth="true" style="-fx-background-color: transparent;">
        <VBox fx:id="registerPatientPanel" visible="true" spacing="20" style="-fx-background-color: #f8f9fa; -fx-padding: 30;">

            <HBox alignment="CENTER_LEFT" spacing="15">
                <Label text="Patient Medical Record" styleClass="header-label" style="-fx-font-size: 22px;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="btnDeletePatient" text="Delete Record" onAction="#handleDeletePatient" styleClass="delete-btn"/>
            </HBox>

            <Separator/>

            <!-- PERSONAL INFO -->
            <Label text="Personal Information" style="-fx-text-fill: -color-primary; -fx-font-weight: bold;"/>

            <GridPane hgap="20" vgap="15">
                <columnConstraints>
                    <ColumnConstraints minWidth="100" />
                    <ColumnConstraints hgrow="ALWAYS" />
                    <ColumnConstraints minWidth="100" />
                    <ColumnConstraints hgrow="ALWAYS" />
                </columnConstraints>

                <Label text="First Name" style="-fx-text-fill: #64748b; -fx-font-size: 11px;" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                <TextField fx:id="firstNameFieldPatient" GridPane.rowIndex="1" GridPane.columnIndex="0"/>

                <Label text="Last Name" style="-fx-text-fill: #64748b; -fx-font-size: 11px;" GridPane.rowIndex="0" GridPane.columnIndex="1"/>
                <TextField fx:id="lastNameFieldPatient" GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                <Label text="Date of Birth" style="-fx-text-fill: #64748b; -fx-font-size: 11px;" GridPane.rowIndex="0" GridPane.columnIndex="2"/>
                <DatePicker fx:id="dateOfBirthPickerPatient" maxWidth="Infinity" GridPane.rowIndex="1" GridPane.columnIndex="2"/>

                <Label text="Gender" style="-fx-text-fill: #64748b; -fx-font-size: 11px;" GridPane.rowIndex="0" GridPane.columnIndex="3"/>
                <!-- FIXED: Made wider to show text -->
                <ComboBox fx:id="genderDropdownPatient" maxWidth="Infinity" minWidth="100" GridPane.rowIndex="1" GridPane.columnIndex="3">
                    <items>
                        <FXCollections fx:factory="observableArrayList">
                            <String fx:value="Male" />
                            <String fx:value="Female" />
                        </FXCollections>
                    </items>
                </ComboBox>
            </GridPane>

            <!-- CONTACT -->
            <Label text="Contact Details" style="-fx-text-fill: -color-primary; -fx-font-weight: bold; -fx-padding: 10 0 0 0;"/>
            <GridPane hgap="20" vgap="15">
                <columnConstraints>
                    <ColumnConstraints hgrow="ALWAYS" />
                    <ColumnConstraints hgrow="ALWAYS" />
                </columnConstraints>
                <Label text="Email Address" style="-fx-text-fill: #64748b; -fx-font-size: 11px;" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
                <TextField fx:id="emailFieldPatient" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
                <Label text="Phone Number" style="-fx-text-fill: #64748b; -fx-font-size: 11px;" GridPane.rowIndex="0" GridPane.columnIndex="1"/>
                <TextField fx:id="phoneNumberFieldPatient" GridPane.rowIndex="1" GridPane.columnIndex="1"/>
            </GridPane>

            <!-- VITALS -->
            <Label text="Medical Vitals" style="-fx-text-fill: -color-primary; -fx-font-weight: bold; -fx-padding: 10 0 0 0;"/>
            <HBox spacing="20">
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="Height (cm)" style="-fx-text-fill: #64748b; -fx-font-size: 11px;"/>
                    <TextField fx:id="heightFieldPatient"/>
                </VBox>
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="Weight (kg)" style="-fx-text-fill: #64748b; -fx-font-size: 11px;"/>
                    <TextField fx:id="weightFieldPatient"/>
                </VBox>
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="Blood Group" style="-fx-text-fill: #64748b; -fx-font-size: 11px;"/>
                    <ComboBox fx:id="bloodGroupDropdownPatient" maxWidth="Infinity">
                        <items>
                            <FXCollections fx:factory="observableArrayList">
                                <String fx:value="A+" /><String fx:value="A-" />
                                <String fx:value="B+" /><String fx:value="B-" />
                                <String fx:value="O+" /><String fx:value="O-" />
                                <String fx:value="AB+" /><String fx:value="AB-" />
                            </FXCollections>
                        </items>
                    </ComboBox>
                </VBox>
            </HBox>

            <Separator/>

            <HBox alignment="CENTER_RIGHT" spacing="15">
                <CheckBox fx:id="isActiveCheckboxPatient" text="Active Patient Record" selected="true"/>
                <Region HBox.hgrow="ALWAYS"/>
                <Button fx:id="btnUpdatePatient" visible="false" managed="false"/>
                <Button fx:id="submitButtonPatient" text="Save Changes" onAction="#handleSubmitPatient" styleClass="action-btn" style="-fx-font-size: 14px; -fx-padding: 10 30;"/>
            </HBox>

        </VBox>
    </ScrollPane>
</SplitPane>